@model bat.logic.Models.Meet
@{
    ViewBag.Title = "Meet";
}

<h2>Teacher: @Model.other.Fname @Model.other.Lname</h2>

<button id="join" class="btn btn-success hidden" onclick="connect()">Join Stream</button>

<div id="streamCon">
    <div id="streamBox" style="width:500px; height:500px"></div>
</div>

<!-- TokBox API  -->
<script src="https://static.opentok.com/v2/js/opentok.min.js"></script>

<!-- Link to local TokBox script  -->
<script type="text/javascript" src="~/assets/js/videoStreaming.js"></script>

<script>
    //These are manually generated session id and token. Production requires Sessions and tokens be generated by server.
    var sessionId = "@Model.session";

    //Publisher Token
    var token = "@Model.token";

    session = OT.initSession(apiKey, sessionId);
    var stream;

    session.on("streamCreated", function (event) {
        stream = event.stream;
        console.log("New stream in the session: " + event.stream.streamId);
        console.log("New stream Name: " + event.stream.name);
        console.log(event.stream);
        $('#join').removeClass("hidden");
    });
    // Replace with a valid token:
    session.connect(token);
    function connect () {
        session.subscribe(stream, streamBox);
    }
</script>
