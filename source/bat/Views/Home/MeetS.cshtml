
@{
    ViewBag.Title = "Meet Subscriber";
}

<h2>Meet - Subscriber</h2>
<div id="replacementElementId"></div>

<!-- TokBox API  -->
<script src="https://static.opentok.com/v2/js/opentok.min.js"></script> 

<!-- Student(subscriber) Page-->
<script>
    var apiKey = "45496652"; //API Key

    //These are manually generated session id and token. Production requires Sessions and tokens be generated by server.
    var sessionId = "2_MX40NTQ5NjY1Mn5-MTQ1NTc1NjMwMzczMH5OeitjZklmeVQzU1o1ZlVrdSt1SzZqbzJ-UH4";

    //Subscriber Token
    var token = "T1==cGFydG5lcl9pZD00NTQ5NjY1MiZzaWc9NTU4Zjc4ZjA0YjFjNDdlZGQwMjE0ODI0Mzc0ZjA5YTM4YWEzY2U2MDpyb2xlPXN1YnNjcmliZXImc2Vzc2lvbl9pZD0yX01YNDBOVFE1TmpZMU1uNS1NVFExTlRjMU5qTXdNemN6TUg1T2VpdGpaa2xtZVZRelUxbzFabFZyZFN0MVN6WnFiekotVUg0JmNyZWF0ZV90aW1lPTE0NTU3NzQzMDUmbm9uY2U9MC44OTcyNjIxMTEwOTg5MzEyJmV4cGlyZV90aW1lPTE0NTU4NDI2NTgmY29ubmVjdGlvbl9kYXRhPQ==";

    var session = OT.initSession(apiKey, sessionId);

    session.connect(token, function (error) {
        if (error) {
            if (error.code === 1006) {
                alert('Failed to connect. Please check your connection and try connecting again.');
            } else {
                alert('An unknown error occurred connecting. Please try again later.');
            }
        } else {
            console.log("Joined stream");
        }
    });
    session.on("streamCreated", function (event) {
        session.subscribe(event.stream);
    });
</script>