@model bat.logic.ViewModels.Lessons.View
@{
    ViewBag.Title = Model.lesson.Description;
}

@section head {
    <link type="text/css" rel="stylesheet" href="@Url.Content("~/assets/css/style.css")" />
    <link type="text/css" rel="stylesheet" href="@Url.Content("~/assets/css/blackboard.css")" />

    <script>
        lessonId = "@Model.lesson.ID";
        id = @Model.account.ID;
        username = "@Model.account.Fname" + " " + "@Model.account.Lname";
    </script>
}
@section scripts {
    @*<script>
            $(document).ready(function () {
                window.open('@Model.lesson.ZoomJoinUrl', '_blank');
            });
        </script>*@
}

<div style="overflow: auto;">
    <h2 class="pull-left" style="margin-bottom: 40px;">
        @Model.lesson.Description
    </h2>
    @if (Model.IsTeacher)
    {
        <div class="pull-right">
            <a href="@Url.Action("Reschedule", new {id = Model.lesson.ID})" class="btn btn-lg btn-default">Reschedule lesson</a>
            <a href="@Url.Action("Edit", new {id = Model.lesson.ID})" class="btn btn-lg btn-default">Edit lesson details</a>
        </div>
    }
</div>

<div class="row">
    <div class="col-md-3">
        <p>
            <strong>
                Teacher
            </strong>
            <br />
            @if (string.IsNullOrEmpty(Model.host.Picture))
            {
                <img style="height: 120px; width: 120px;" src="@Url.Content("~/assets/img/default-avatar.png")" alt="Profile Pic" />
            }
            else {
                <img style="height: 120px; width: 120px;" src="@Url.Action("DownloadResource", "ProfilePictureApi", new { id = Model.host.ID, name = Model.host.Fname})" alt="Profile Pic" />
            }
            <br />
            @Model.host.Fname @Model.host.Lname
        </p>
    </div>
    <div class="col-md-4">
        <p>
            <strong>
                @Model.lesson.Subject
            </strong>
        </p>
        <p>
            Date: @Model.lesson.BookingDate.ToString("dd/MM/yyyy hh:mm tt")
        </p>
        <p>
            Duration mins: @Model.lesson.DurationMins
            &nbsp;&nbsp;&nbsp;&nbsp;
            Class size: @Model.lesson.ClassSize
        </p>
    </div>
    <div class="col-md-3">
        <p>
            <strong>
                Attendees
            </strong>
            @foreach (var student in Model.others)
            {
                <text>
                    <br />
                    @student.Fname @student.Lname
                </text>
            }
        </p>
    </div>
    <div class="col-md-2">
        <a href="@Model.lesson.ZoomJoinUrl" target="_blank" class="btn btn-lg btn-primary">
            Join session
        </a>
    </div>
</div>

<div class="row" style="height: 40px;">
    <div class="col-md-6">
        @Html.Partial("_PartialWhiteboard", Model)
    </div>
    <div class="col-md-6">
        <div>
            @Html.Raw(HttpUtility.UrlDecode(Model.lesson.DetailedDescription))
        </div>
        @Html.Partial("_PartialChatBox", Model)
        <div>
            <table class="table">
                <tr>
                    <th>
                        Lesson Resources
                    </th>
                </tr>
                @foreach (var resource in Model.lessonResources)
            {
                    <tr>
                        <td>
                            <a href="@Url.Action("downloadresource", "lessons", new { id = resource.ID, name = resource.Original_Name})"> @resource.Original_Name </a>
                        </td>
                    </tr>
                }
            </table>
        </div>
    </div>
</div>